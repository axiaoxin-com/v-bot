package weiboclock

import (
	"math/rand"
	"strings"
	"time"

	"github.com/pkg/errors"
)

var (
	// TollTails æ ‡ç‚¹å°å°¾å·´
	TollTails = []string{
		"!", "~", ".", "?",
	}

	// ClockEmoji æ•´ç‚¹emoji
	ClockEmoji = []string{"ðŸ•›", "ðŸ•", "ðŸ•‘", "ðŸ•’", "ðŸ•“", "ðŸ•”", "ðŸ••", "ðŸ•–", "ðŸ•—", "ðŸ•˜", "ðŸ•™", "ðŸ•š", "ðŸ•›"}

	// TextEmotions é¢œæ–‡å­—è¡¨æƒ…
	TextEmotions = []string{
		"(Â°ãƒ¼Â°ã€ƒ)", "_(:Ð·ã€âˆ )_ ", "o(*â‰§â–½â‰¦)ãƒ„â”â”â”“", "à¹‘ä¹›â—¡ä¹›à¹‘ ", "(Ïƒâ€˜ãƒ»Ð´ï½¥)Ïƒ", "( ï¼¿ ï¼¿)ãƒŽï½œ", "â”‘(ï¿£Ð” ï¿£)â”",
		"(ï¼ƒÂ°Ð”Â°)", "(-Ï‰- )", "(â€²ãƒ»Ï‰ãƒ»`)", "( ^Ï‰^)", "ä¹€(Ë‰ÎµË‰ä¹€)", "Ê•â€¢Ì«Í¡â€¢Ê•â€¢Ì«Í¡â€¢Ê”â€¢Ì«Í¡â€¢Ê”", "(à¹‘â€¾á·†Ð´â€¾á·‡à¹‘)FightáµŽáµŽ", "ê’°ï½¡â»à¯°â»ï½¡ê’±",
		"\\(â•¯-â•°)/", "\\(â–”â–½â–”)/", "^(oo)^", "(O^~^O)", "ï¼ˆâ•¯ï¼¾â•°ï¼‰", "(*ï¾Ÿâˆ€ï¾Ÿ*)", "(à°¶Ï‰à°¶)", "(*Â´âˆ€`)~â™¥", "Ïƒ`âˆ€Â´)Ïƒ",
		"(ã€ƒâˆ€ã€ƒ)", "(^_ã£^)", "(ï½¡â—•âˆ€â—•ï½¡)", "ãƒ½(âœ¿ï¾Ÿâ–½ï¾Ÿ)ãƒŽ", "ÎµÙ©(à¹‘> â‚ƒ <)Û¶Ð·", "(Ïƒâ€²â–½â€µ)â€²â–½â€µ)Ïƒ", "Ïƒ ï¾Ÿâˆ€ ï¾Ÿ) ï¾Ÿâˆ€ï¾Ÿ)Ïƒ",
		"ï½¡:.ï¾Ÿãƒ½(*Â´âˆ€`)ï¾‰ï¾Ÿ.:ï½¡", "(âœªÏ‰âœª)", "(âˆ‚Ï‰âˆ‚)", "â”€=â‰¡Î£((( ã¤â€¢Ì€Ï‰â€¢Ì)ã¤", "(à¹‘Â´Ú¡`à¹‘)", "(Â´â–½`Êƒâ™¡Æª)", "(â›â—¡â›âœ¿)", "(ç¬ÂºÏ‰Âºç¬)",
		"(ï¿£â–½ï¿£)/", "â•°(*Â°â–½Â°*)â•¯", "(à¹‘â€¢Ì€ã…‚â€¢Ì)Ùˆâœ§", "( ^Ï‰^)", "Ù©(ï½¡ãƒ»Ï‰ãƒ»ï½¡)Ùˆ", "( ï½ž'Ï‰')ï½ž", "(à¹‘Æ¡ â‚ƒ Æ¡)â™¥", "(ï¾‰â—•ãƒ®â—•)ï¾‰*:ï½¥ï¾Ÿâœ§",
		"o(â˜†Ð¤âˆ‡Ð¤â˜†)o", "(ï¿«Ü«ï¿©)", "(â™¥Ð´â™¥)", "âœ§â—(â°â–¿â°)â—œâœ§", "(á—’á—¨á—•)/", "(=Â´Ï‰`=)", "(ï½¢ï½¥Ï‰ï½¥)ï½¢", "(*Â´Ð´`)", "Î£>â€•(ã€ƒÂ°Ï‰Â°ã€ƒ)â™¡â†’",
		"(â–°Ë˜â—¡Ë˜â–°)", "ãƒ¾(Â´Îµ`ãƒ¾)", "(ã£â—Ï‰â—)ã£", "â—¥(à¸…Âºï¿¦Âºà¸…)â—¤", "ãƒ½( Â° â–½Â°)ãƒŽ", "(ã€€ï¾Ÿâˆ€ï¾Ÿ) ï¾‰â™¡", "âœ§*ï½¡Ù©(ËŠá—œË‹*)Ùˆâœ§*ï½¡",
		"â½â½â—Ÿ(âˆ— ËŠÏ‰Ë‹ âˆ—)â—ž â¾â¾", "ãƒ¾(Â´ï¸¶`*)ï¾‰â™¬", "ãƒ¾(*Â´âˆ€ Ë‹*)ï¾‰", "(à¹‘â€¢Ì€Ï‰â€¢Ì)ãƒŽ", "ãƒ¾ (o Â° Ï‰ Â° O ) ãƒŽã‚™ ", "â•®(â•¯_â•°)â•­", "(à¹‘â€¢Ì â‚ƒ â€¢Ì€à¹‘)",
		"(Â´ï½¥_ï½¥`)", "(ã††á´—ã††)", "â”(Â´Ð´`)â”Œ", "( Ë˜ï½¥Ð·ï½¥)", "( Â´â€¢ï¸µâ€¢` )", "(ï½¡Å_Å)", "(â—žâ€¸â—Ÿ)", "( Ë˜â€¢Ï‰â€¢Ë˜ )", "(ëˆˆâ€¸ëˆˆ)", "(Â´ï½¥Ï‰ï½¥`)",
		"(*Â´è‰¸`*)", "(ã€ƒâˆ€ã€ƒ)", "(ã¤Ð´âŠ‚)", "(à¹‘Â´ã…‚`à¹‘)", "ÎµÙ©(à¹‘> â‚ƒ <)Û¶Ð·", "(à¹‘Â´Ú¡`à¹‘)", "(ç¬ÂºÏ‰Âºç¬)", "(à¹‘â€¢ . â€¢à¹‘)",
		"(à¹‘Æ¡ â‚ƒ Æ¡)â™¥", "(â—ï½€ è‰¸Â´)", ",,Ô¾â€¸Ô¾,,", "(ã€ƒï¾ŸÐ´ï¾Ÿã€ƒ)", "(à¹‘Â´ã…`)", "(à¹‘Â¯âˆ€Â¯à¹‘)", "(ã€ƒÂ´âˆ€ï½€)", "(â‹Ÿï¹â‹ž)", "(ãƒŽÐ´T)",
		"(T_T)", "ï¼šï¾Ÿ(ï½¡ï¾‰Ï‰ï¼¼ï½¡)ï¾Ÿï½¥ï½¡", "(TÐ´T)", "(â˜ï¹â°)", "(â•¥ï¹â•¥)", "ï½¡ï¾Ÿ(ï¾ŸÂ´Ï‰`ï¾Ÿ)ï¾Ÿï½¡", "à®‡Ð´à®‡", "ï½¡ï¾Ÿãƒ½(ï¾ŸÂ´Ð”`)ï¾‰ï¾Ÿï½¡", "ã€‚ï½¥ï¾Ÿï½¥(ã¤Ð´`ï¾Ÿ)ï½¥ï¾Ÿï½¥",
		"(ï¾ŸÐ´âŠ™)", "(â€˜âŠ™Ð´-)", "Î£(*ï¾ŸÐ´ï¾Ÿï¾‰)ï¾‰", "(((ï¾ŸÐ”ï¾Ÿ;)))", "(((ï¾ŸÐ´ï¾Ÿ)))", "(â˜‰Ð´âŠ™)", "(|||ï¾ŸÐ´ï¾Ÿ)",
		"(Â´âŠ™Ï‰âŠ™`)", "à¸…(à¹‘*Ð´*à¹‘)à¸…!!", "(ã‚œãƒ­ã‚œ)", "(âœ˜ï¹âœ˜áƒ)", "(âœ˜Ð”âœ˜à¹‘ )", "(â•¬â˜‰Ð´âŠ™)", "(ï¼â€µÐ”â€²)ï¼~ â•§â•§", "(â•¯â€µâ–¡â€²)â•¯ï¸µâ”´â”€â”´",
		"(â—“Ð”â—’)âœ„â•°â‹ƒâ•¯", "(ï¾’ï¾ŸÐ”ï¾Ÿ)ï¾’", "(`ã¸Â´â‰ )", "(#ï¾ŸâŠ¿`)å‡¸", "(â•¬â–¼Ð´ï¾Ÿ)", "(á—’á—£á—•)Õž", "( à¸´â—•ã‰¨â—• à¸´)", "(âá´¥âÊ‹)", "(â—•Ü«â—•)", "(Î¦Ï‰Î¦)",
		"à¸à¹‡Ê•â€¢Í¡á´¥â€¢Ê” à¸à¹‰", "(=Â´Ï‰`=)", "(â°âŠ–â°)", "(=Â´á´¥`)", "à¸…â—Ï‰â—à¸…", "( Â° ÍœÊ–Í¡Â°)â•­âˆ©â•®", "(âŒâ–€Í¡ Ì¯Ê–â–€)", "(ï½¥à¸´Ï‰ï½¥à¸´)", "Ê•â€¢Ì€Ï‰â€¢ÌÊ”âœ§", "Ù©(â™¡Îµâ™¡ )Û¶", "Ù©(à¹‘Â´3ï½€à¹‘)Û¶",
		"(à¹‘â€¢Ì€ã…â€¢Ìà¹‘)âœ§", "â€¢Ì€.Ì«â€¢Ìâœ§", "â½â½Ù©(à¹‘ËƒÌ¶ÍˆÌ€ á—¨ Ë‚Ì¶ÍˆÌ)Û¶â¾â¾", "( â€¢Ì€á„‡â€¢ Ì)ï»­âœ§", "(â–­-â–­)âœ§", "(â–­-â–­)âœ§",
		"(â¸â¸â¸áµ’Ì´Ì¶Ì¥Ì âŒ‘ áµ’Ì´Ì¶Ì£Ì¥Ì€â¸â¸â¸)", "((ÌµÌÌµ Ì†Í’ÍŸËšÌ©Ì­ Ì†Í’)ÌµÌ€Ìµ)ï¾ž", "oÌ–â¸œ((ÌµÌÌµ Ì†Í’ÍŸËšÌ©Ì­ Ì†Í’)ÌµÌ€Ìµ)â¸oÌ—", "Ù©(ËŠá—œË‹*)Ùˆ", "(âˆ©áµ’Ì´Ì¶Ì·Ì¤âŒ”áµ’Ì´Ì¶Ì·Ì¤âˆ©)", "â‚â‚ â—Ÿê’° â€¾á·…Ð´Ìˆ â€¾á·„ â•¬ê’±", "à¬˜(à©­ËŠê’³Ë‹)à©­âœ§", "Ê•Â·Í¡Â·Ì«Í–Ê•âŽÌ¯Í¡âŽÊ”",
	}

	// WeiboEmotions å¾®åšå®˜æ–¹è¡¨æƒ…ï¼Œweiboclock Runæ–¹æ³•è°ƒç”¨æ—¶è¿›è¡Œåˆå§‹åŒ–
	WeiboEmotions = []string{}

	// Emotions å…¨éƒ¨è¡¨æƒ… TextEmotions + åˆå§‹åŒ–åŽçš„WeiboEmotions
	Emotions = []string{}
)

// PickOneEmotion éšæœºé€‰æ‹©ä¸€ä¸ªè¡¨æƒ…
func PickOneEmotion() string {
	rand.Seed(time.Now().Unix())
	return Emotions[rand.Intn(len(Emotions))]
}

// TollTail éšæœºèŽ·å–æ ‡ç‚¹å°å°¾å·´~
func TollTail(count int) string {
	rand.Seed(time.Now().Unix())
	tail := TollTails[rand.Intn(len(TollTails))]
	return strings.Repeat(tail, count)
}

// InitEmotions åˆå§‹åŒ–è¡¨æƒ…ï¼Œè¿”å›žè¡¨æƒ…æ€»æ•°
func (clock *WeiboClock) InitEmotions() (int, error) {
	// reset
	Emotions = []string{}
	WeiboEmotions = []string{}

	// èŽ·å–å¾®åšå®˜æ–¹è¡¨æƒ…
	vb := clock.cronWeibo.WeiboClient()
	token := clock.cronWeibo.Token()
	language := "cnname"
	emotionType := "face"
	emotions, err := vb.Emotions(token.AccessToken, emotionType, language)
	if err != nil {
		return 0, errors.Wrap(err, "weiboclock InitWeiboEmotions Emotions error")
	}
	for _, emotion := range *emotions {
		WeiboEmotions = append(WeiboEmotions, emotion.Phrase)
		Emotions = append(Emotions, emotion.Phrase)
	}
	Emotions = append(Emotions, TextEmotions...)
	return len(Emotions), nil
}
